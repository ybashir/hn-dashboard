(this["webpackJsonphn-dashboard"]=this["webpackJsonphn-dashboard"]||[]).push([[0],{252:function(t,e,a){},253:function(t,e,a){},256:function(t,e,a){},261:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(31),s=a.n(i),c=(a(252),a(3)),o=(a(253),a(263)),l=a(268),u=a(62),h=a(40),d=a(264),p=a(265),f=a(271),g=(a(254),a(21)),b=a(13),m=a(14),y=a(15),v=a(16),j=a(22),x=(a(256),a(153)),O=a(266),k=a(269),w=a(270),z=a(10),C=function(t){Object(y.a)(a,t);var e=Object(v.a)(a);function a(){var t;Object(b.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).state={data:[],width:500,duration:250,interpolated_frames:5,currentKF:0,intervalId:0,isPlaying:!1,keyframes:[]},t.resizeObserver=null,t.width=100,t.svgElement=r.a.createRef(),t.resizeElement=r.a.createRef(),t.scale=j.m(j.n),t.formatDate=j.p("%Y"),t.categories=[],t.stopPlaying=function(){t.setState({isPlaying:!1}),clearInterval(t.state.intervalId)},t.startPlaying=function(){var e=setInterval(t.timer,t.state.duration);t.setState({isPlaying:!0,intervalId:e,currentKF:t.state.currentKF===t.state.keyframes.length-1?0:t.state.currentKF})},t.togglePlay=function(){t.state.isPlaying?t.stopPlaying():t.startPlaying()},t.handleFrameChange=function(e){t.state.isPlaying&&t.stopPlaying(),t.updateChart(+e)},t.timer=function(){t.state.currentKF<t.state.keyframes.length-1?t.updateChart(t.state.currentKF+1):t.stopPlaying()},t}return Object(m.a)(a,[{key:"updateX",value:function(){this.x=j.l([0,1],[this.props.margin.left,this.state.width-this.props.margin.right])}},{key:"updateY",value:function(){this.y=j.k().domain(j.i(this.props.bars+1)).rangeRound([this.props.margin.top,this.props.margin.top+this.props.barSize*(this.props.bars+1+.1)]).padding(.1)}},{key:"updateChart",value:function(t){var e=this;this.setState({currentKF:t},(function(){e.drawChart()}))}},{key:"drawChart",value:function(){var t=j.o(this.svgElement.current),e=this.state.keyframes[this.state.currentKF],a=t.transition().duration(this.state.duration).ease(j.e);this.x.domain([0,e[1][0].value]),this.updateAxis(e,a),this.updateBars(e,a),this.updateLabels(e,a),this.updateTicker(e,a)}},{key:"bars",value:function(t){var e=this,a=t.append("g").attr("fill-opacity",.6).selectAll("rect");return function(t,n){var r=Object(c.a)(t,2),i=(r[0],r[1]);a=a.data(i.slice(0,e.props.bars),(function(t){return t.name})).join((function(t){return t.append("rect").attr("fill",e.color()).attr("height",e.y.bandwidth()).attr("x",e.x(0)).attr("y",e.y(e.props.bars)).attr("width",(function(t){return e.x(t.value)-e.x(0)}))}),(function(t){return t}),(function(t){return t.transition(n).remove().attr("y",e.y(e.props.bars)).attr("width",(function(t){return e.x(t.value)-e.x(0)}))})).call((function(t){return t.transition(n).attr("y",(function(t){return e.y(t.rank)})).attr("width",(function(t){return e.x(t.value)-e.x(0)}))}))}}},{key:"labels",value:function(t){var e=this,a=t.append("g").style("font","bold 12px var(--sans-serif)").style("font-size","12px").style("font-weight","bold").style("font-variant-numeric","tabular-nums").attr("text-anchor","end").selectAll("text"),n=this.textTween;return function(t,r){var i=Object(c.a)(t,2),s=(i[0],i[1]);return a=a.data(s.slice(0,e.props.bars),(function(t){return t.name})).join((function(t){return t.append("text").attr("transform",(function(t){return"translate(".concat(e.x(t.value),",").concat(e.y(e.props.bars),")")})).attr("y",e.y.bandwidth()/2).attr("x",-6).attr("dy","-0.25em").text((function(t){return t.name})).call((function(t){return t.append("tspan").attr("fill-opacity",.7).attr("font-weight","normal").attr("x",-6).attr("dy","1.15em")}))}),(function(t){return t}),(function(t){return t.transition(r).remove().attr("transform",(function(t){return"translate(".concat(e.x(t.value),",").concat(e.y(e.props.bars),")")}))})).call((function(t){return t.transition(r).attr("transform",(function(t){return"translate(".concat(e.x(t.value),",").concat(e.y(t.rank),")")})).call((function(t){return t.select("tspan").tween("text",(function(t){return n(+this.textContent.replace(/,/g,""),t.value)}))}))}))}}},{key:"ticker",value:function(t){var e=this,a=t.append("text").style("font-weight","bold").style("font-size","".concat(this.props.barSize,"px")).style("font-variant-numeric","tabular-nums").attr("text-anchor","end").attr("x",this.state.width-6).attr("y",this.props.margin.top+this.props.barSize*(this.props.bars-.45)).attr("dy","0.32em").text(this.formatDate(this.state.keyframes[0][0]));return function(t,n){Object(c.a)(t,1)[0];var r=e.state.keyframes[e.state.currentKF][0].toLocaleDateString("en-US",{year:"numeric",month:"short"});a.attr("x",e.state.width-6),a.text(r)}}},{key:"axis",value:function(t){var e=this,a=t.append("g").attr("transform","translate(0,".concat(this.props.margin.top,")")),n=j.b(this.x).ticks(this.state.width/160).tickSizeOuter(0).tickSizeInner(-this.props.barSize*(this.props.bars+this.y.padding()));return function(t,r){n.ticks(e.state.width/160),a.transition(r).call(n),a.select(".tick:first-of-type text").remove(),a.selectAll(".tick:not(:first-of-type) line").attr("stroke","white"),a.select(".domain").remove()}}},{key:"color",value:function(){var t=j.m(j.n);if(this.state.data.some((function(t){return void 0!==t.category}))){var e=new Map(this.state.data.map((function(t){return[t.name,t.category]})));return t.domain(e.values()),function(a){return t(e.get(a.name))}}return function(e){return t(e.name)}}},{key:"textTween",value:function(t,e){var a=j.g(t,e);return function(t){this.textContent=j.f(",d")(a(t))}}},{key:"rank",value:function(t,e,a,n){var r=new Set(n.map((function(t){return t.name}))),i=Array.from(r,(function(n){return{name:n,value:(t.get(n)||0)*(1-a)+(e.get(n)||0)*a}}));i.sort((function(t,e){return j.d(t.value,e.value)}));for(var s=0;s<i.length;++s)i[s].rank=Math.min(this.props.bars,s);return i}},{key:"getKeyFrames",value:function(t){var e,a,n,r,i,s=this.state.interpolated_frames,o=Array.from(j.j(t,(function(t){return Object(c.a)(t,1)[0].value}),(function(t){return+t.date}),(function(t){return t.name}))).map((function(t){var e=Object(c.a)(t,2),a=e[0],n=e[1];return[new Date(a),n]})).sort((function(t,e){var a=Object(c.a)(t,1)[0],n=Object(c.a)(e,1)[0];return j.a(a,n)})),l=[],u=j.h(o),h=Object(g.a)(u);try{for(h.s();!(i=h.n()).done;){var d=Object(c.a)(i.value,2),p=Object(c.a)(d[0],2);e=p[0],a=p[1];var f=Object(c.a)(d[1],2);n=f[0],r=f[1];for(var b=0;b<s;++b){var m=b/s;l.push([new Date(e*(1-m)+n*m),this.rank(a,r,m,t)])}}}catch(y){h.e(y)}finally{h.f()}return l.push([new Date(n),this.rank(a,r,1,t)]),l}},{key:"getDateFromString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t.split("-"),n=Object(c.a)(a,2),r=n[0],i=n[1];return e?new Date(r,i,0):new Date(r,i-1,1)}},{key:"componentDidUpdate",value:function(t){var e=this;if(this.props.dateRange&&this.props.dateRange!==t.dateRange){var a=this.getDateFromString(this.props.dateRange[0]),n=this.getDateFromString(this.props.dateRange[1],!0),r=this.state.data.filter((function(t){return t.date>=a&&t.date<=n})),i=this.getKeyFrames(r);this.setState({keyframes:i},(function(){e.drawChart()}))}}},{key:"componentWillUnmount",value:function(){this.resizeObserver&&this.resizeObserver.disconnect()}},{key:"componentDidMount",value:function(){var t=this,e=this.refs.child.parentNode.clientWidth;this.resizeObserver=new ResizeObserver((function(e){var a,n=Object(g.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;t.setState({width:r.target.clientWidth},(function(){t.state.keyframes.length>0&&(t.updateX(),t.drawChart())}))}}catch(i){n.e(i)}finally{n.f()}})),this.resizeObserver.observe(this.resizeElement.current),this.props.dataset.then((function(a){var n=t.getKeyFrames(a),r=new Map(a.map((function(t){return[t.name,t.category]})));t.scale.domain(r.values());var i={};a.forEach((function(t){""!==t.category&&(t.category in i?i[t.category]=i[t.category]+t.value:i[t.category]=t.value)})),t.categories=Object.entries(i).sort((function(t,e){return e[1]-t[1]})).map((function(t){return t[0]})).slice(0,t.props.bars),t.setState({data:a,width:e,keyframes:n},(function(){var e=j.o(t.svgElement.current);t.updateX(),t.updateY(),t.updateBars=t.bars(e),t.updateAxis=t.axis(e),t.updateLabels=t.labels(e),t.updateTicker=t.ticker(e),t.drawChart()}))}))}},{key:"render",value:function(){var t=this;return Object(z.jsxs)("div",{ref:"child",children:[Object(z.jsxs)(u.a,{children:[Object(z.jsx)(h.a,{flex:"40px",align:"left",children:Object(z.jsx)(x.a,{type:"primary",style:{align:"left"},icon:this.state.isPlaying?Object(z.jsx)(k.a,{}):Object(z.jsx)(w.a,{}),onClick:this.togglePlay})}),Object(z.jsxs)(h.a,{flex:"auto",children:[" ",Object(z.jsx)(O.a,{id:"typeinp",min:0,max:this.state.keyframes.length-1,value:this.state.currentKF,defaultValue:0,onChange:this.handleFrameChange,tooltipVisible:!1,step:1})]})]}),Object(z.jsx)(u.a,{children:Object(z.jsx)(h.a,{span:"24",ref:this.resizeElement,children:Object(z.jsx)("svg",{ref:this.svgElement,style:{width:"100%",height:this.props.margin.top+this.props.margin.bottom+this.props.barSize*this.props.bars,marginRight:this.props.margin.right,marginLeft:this.props.margin.left}})})}),Object(z.jsx)("br",{}),Object(z.jsx)(u.a,{align:"middle",children:this.categories.map((function(e){return Object(z.jsx)(h.a,{flex:"left",children:Object(z.jsxs)(u.a,{children:[Object(z.jsx)(h.a,{className:"legend-box",style:{backgroundColor:t.scale(e)}}),Object(z.jsx)(h.a,{className:"legend-label",align:"left",children:e})]})})}))})]})}}]),a}(r.a.Component),S=a(39),D=a.n(S),F=function(t){var e=t.children;return Object(z.jsxs)(o.a,{children:[Object(z.jsxs)(o.a.Header,{children:[Object(z.jsx)("div",{style:{float:"left"},children:Object(z.jsx)("h2",{style:{color:"#fff",margin:0,marginRight:"1em"},children:"HackerNews Who's Hiring: Analytics"})}),Object(z.jsx)("div",{style:{float:"right"},children:Object(z.jsx)(l.a,{theme:"dark",mode:"horizontal",style:{lineHeight:"64px"},children:Object(z.jsx)(l.a.Item,{children:Object(z.jsxs)("a",{href:"https://github.com/ybashir/hn-dashboard",children:[Object(z.jsx)(f.a,{}),"\xa0 Github"]})},"1")})})]}),Object(z.jsx)(o.a.Content,{style:{padding:"0 25px 25px 25px",margin:"25px auto",width:"100%",maxWidth:1200},children:e})]})},P=function(t){var e=t.children,a=(t.onPreAggChange,t.onDateRangeChange);t.onCategoryChange;return[Object(z.jsx)(u.a,{type:"flex",justify:"space-around",align:"top",children:Object(z.jsx)(h.a,{span:24,lg:24,align:"right",children:Object(z.jsx)(d.a.RangePicker,{picker:"month",onChange:function(t,e){return a(e)},defaultValue:[D()("2014/01/01","YYYY/MM/DD"),D()("2021/10/01","YYYY/MM/DD")]})})}),Object(z.jsx)(u.a,{type:"flex",justify:"space-around",align:"top",gutter:24,children:e})]},R=function(t){var e=t.children,a=t.title,n=t.size,r=t.height;return Object(z.jsx)(h.a,{span:24,lg:n,children:Object(z.jsx)(p.a,{title:a,style:{marginBottom:"24px"},children:Object(z.jsx)("div",{style:{height:r},children:e})})})};R.defaultProps={size:12};var K=function(){var t=j.c("data/tech_by_month_flat.csv",(function(t){return{date:new Date(t.date),name:t.name,category:t.category,value:+t.value}})),e=j.c("data/location_by_month_flat.csv",(function(t){return{date:new Date(t.date),name:t.name,category:t.category,value:+t.value}})),a=Object(n.useState)(0),r=Object(c.a)(a,2),i=r[0],s=r[1];return Object(z.jsx)("div",{className:"App",children:Object(z.jsx)(F,{children:Object(z.jsxs)(P,{onDateRangeChange:function(t){return s(t)},children:[Object(z.jsx)(R,{size:24,title:"Most popular tech keywords in HN job ads",children:Object(z.jsx)(C,{dataset:t,bars:12,barSize:32,dateRange:i,margin:{top:20,right:6,bottom:6,left:0}})}),Object(z.jsx)(R,{size:24,title:"Most popular locations in HN job ads",children:Object(z.jsx)(C,{dataset:e,bars:12,barSize:32,dateRange:i,margin:{top:20,right:6,bottom:6,left:0}})})]})})})};s.a.render(Object(z.jsx)(r.a.StrictMode,{children:Object(z.jsx)(K,{})}),document.getElementById("root"))}},[[261,1,2]]]);
//# sourceMappingURL=main.55490450.chunk.js.map